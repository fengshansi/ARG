lr: 5e-05; model name: ARG-D; batchsize: 64; epoch: 50; gpu: 1;
data_type: rationale; data_path: /home/tzh/ARG/data/en; data_name: en-argd;
before in config
{'use_cuda': True, 'seed': 3759, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'en', 'root_path': '/home/tzh/ARG/data/en', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.0, 'rationale_usefulness_evaluator_weight': 1.5, 'kd_loss_weight': 1.0}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 5e-05, 'epoch': 50, 'model_name': 'ARG-D', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/bert-base-uncased', 'data_type': 'rationale', 'data_name': 'en-argd', 'eval_mode': False, 'teacher_path': './param_model/ARG_en-arg/1/parameter_bert.pkl', 'month': 1}
{'lr': [5e-05]}



==================== start training ====================
----- model initiating finish -----
time cost in model and data loading: 72.36436462402344s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.8472186853413974, 'spauc': 0.7223711435201086, 'metric': 0.7503049592071354, 'f1_real': 0.9018075232046898, 'f1_fake': 0.5988023952095809, 'recall': 0.7554353016075124, 'recall_real': 0.8961165048543689, 'recall_fake': 0.6147540983606558, 'precision': 0.7456144378254499, 'precision_real': 0.9075712881022615, 'precision_fake': 0.5836575875486382, 'acc': 0.8422291993720565}
Max {'auc': 0.8472186853413974, 'spauc': 0.7223711435201086, 'metric': 0.7503049592071354, 'f1_real': 0.9018075232046898, 'f1_fake': 0.5988023952095809, 'recall': 0.7554353016075124, 'recall_real': 0.8961165048543689, 'recall_fake': 0.6147540983606558, 'precision': 0.7456144378254499, 'precision_real': 0.9075712881022615, 'precision_fake': 0.5836575875486382, 'acc': 0.8422291993720565}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8546235874582206, 'spauc': 0.7339311592685358, 'metric': 0.7661395658766345, 'f1_real': 0.9175797999047166, 'f1_fake': 0.6146993318485523, 'recall': 0.7502626134012415, 'recall_real': 0.9349514563106797, 'recall_fake': 0.5655737704918032, 'precision': 0.7870063200164275, 'precision_real': 0.9008419083255379, 'precision_fake': 0.6731707317073171, 'acc': 0.8642072213500785}
Max {'auc': 0.8546235874582206, 'spauc': 0.7339311592685358, 'metric': 0.7661395658766345, 'f1_real': 0.9175797999047166, 'f1_fake': 0.6146993318485523, 'recall': 0.7502626134012415, 'recall_real': 0.9349514563106797, 'recall_fake': 0.5655737704918032, 'precision': 0.7870063200164275, 'precision_real': 0.9008419083255379, 'precision_fake': 0.6731707317073171, 'acc': 0.8642072213500785}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.8575282508355881, 'spauc': 0.7374075408160702, 'metric': 0.7597714113843146, 'f1_real': 0.924009324009324, 'f1_fake': 0.5955334987593053, 'recall': 0.7269696005093108, 'recall_real': 0.962135922330097, 'recall_fake': 0.4918032786885246, 'precision': 0.8217531094001185, 'precision_real': 0.8887892376681614, 'precision_fake': 0.7547169811320755, 'acc': 0.8720565149136578}
Max {'auc': 0.8546235874582206, 'spauc': 0.7339311592685358, 'metric': 0.7661395658766345, 'f1_real': 0.9175797999047166, 'f1_fake': 0.6146993318485523, 'recall': 0.7502626134012415, 'recall_real': 0.9349514563106797, 'recall_fake': 0.5655737704918032, 'precision': 0.7870063200164275, 'precision_real': 0.9008419083255379, 'precision_fake': 0.6731707317073171, 'acc': 0.8642072213500785}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.8598201496100588, 'spauc': 0.7390410213022609, 'metric': 0.7624575256629054, 'f1_real': 0.9118072289156627, 'f1_fake': 0.6131078224101479, 'recall': 0.7563544485118574, 'recall_real': 0.9184466019417475, 'recall_fake': 0.5942622950819673, 'precision': 0.7692254654102506, 'precision_real': 0.9052631578947369, 'precision_fake': 0.6331877729257642, 'acc': 0.8563579277864992}
Max {'auc': 0.8546235874582206, 'spauc': 0.7339311592685358, 'metric': 0.7661395658766345, 'f1_real': 0.9175797999047166, 'f1_fake': 0.6146993318485523, 'recall': 0.7502626134012415, 'recall_real': 0.9349514563106797, 'recall_fake': 0.5655737704918032, 'precision': 0.7870063200164275, 'precision_real': 0.9008419083255379, 'precision_fake': 0.6731707317073171, 'acc': 0.8642072213500785}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.8648694890975647, 'spauc': 0.7400462400629937, 'metric': 0.764423076923077, 'f1_real': 0.9134615384615385, 'f1_fake': 0.6153846153846154, 'recall': 0.7562470157568041, 'recall_real': 0.9223300970873787, 'recall_fake': 0.5901639344262295, 'precision': 0.7738095238095238, 'precision_real': 0.9047619047619048, 'precision_fake': 0.6428571428571429, 'acc': 0.858712715855573}
Max {'auc': 0.8546235874582206, 'spauc': 0.7339311592685358, 'metric': 0.7661395658766345, 'f1_real': 0.9175797999047166, 'f1_fake': 0.6146993318485523, 'recall': 0.7502626134012415, 'recall_real': 0.9349514563106797, 'recall_fake': 0.5655737704918032, 'precision': 0.7870063200164275, 'precision_real': 0.9008419083255379, 'precision_fake': 0.6731707317073171, 'acc': 0.8642072213500785}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}
Max {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.8597047588731497, 'spauc': 0.739041021302261, 'metric': 0.7371887893014653, 'f1_real': 0.8828282828282827, 'f1_fake': 0.5915492957746479, 'recall': 0.7685341397421614, 'recall_real': 0.8485436893203884, 'recall_fake': 0.6885245901639344, 'precision': 0.7192592592592593, 'precision_real': 0.92, 'precision_fake': 0.5185185185185185, 'acc': 0.8178963893249608}
Max {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}

---------- epoch 7 ----------
----- in val progress... -----
current {'auc': 0.8440673245265001, 'spauc': 0.729554269247845, 'metric': 0.7509339444782106, 'f1_real': 0.9010773751224289, 'f1_fake': 0.6007905138339922, 'recall': 0.7580773515836384, 'recall_real': 0.8932038834951457, 'recall_fake': 0.6229508196721312, 'precision': 0.7446217904233171, 'precision_real': 0.9090909090909091, 'precision_fake': 0.5801526717557252, 'acc': 0.8414442700156985}
Max {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}

---------- epoch 8 ----------
----- in val progress... -----
current {'auc': 0.8532349196243831, 'spauc': 0.733156303140471, 'metric': 0.7670405982905983, 'f1_real': 0.9144230769230768, 'f1_fake': 0.6196581196581198, 'recall': 0.7587816329778768, 'recall_real': 0.9233009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7765178571428571, 'precision_real': 0.9057142857142857, 'precision_fake': 0.6473214285714286, 'acc': 0.8602825745682888}
Max {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}

---------- epoch 9 ----------
----- in val progress... -----
current {'auc': 0.82844978513449, 'spauc': 0.723899913718723, 'metric': 0.7547442332718406, 'f1_real': 0.9174138744690892, 'f1_fake': 0.5920745920745921, 'recall': 0.732090561833519, 'recall_real': 0.9436893203883495, 'recall_fake': 0.5204918032786885, 'precision': 0.7895242349787804, 'precision_real': 0.8925619834710744, 'precision_fake': 0.6864864864864865, 'acc': 0.8626373626373627}
Max {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}

---------- epoch 10 ----------
----- in val progress... -----
current {'auc': 0.8377327709692823, 'spauc': 0.7334704340032, 'metric': 0.7650536182786113, 'f1_real': 0.9127710843373494, 'f1_fake': 0.6173361522198731, 'recall': 0.7588890657329301, 'recall_real': 0.9194174757281554, 'recall_fake': 0.5983606557377049, 'precision': 0.7718873404233092, 'precision_real': 0.9062200956937799, 'precision_fake': 0.6375545851528385, 'acc': 0.8579277864992151}
Max {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}

test results: {'auc': 0.8629849425747862, 'spauc': 0.7577044323549258, 'metric': 0.7806723465752504, 'f1_real': 0.919103313840156, 'f1_fake': 0.6422413793103449, 'recall': 0.7788252871260684, 'recall_real': 0.9208984375, 'recall_fake': 0.6367521367521367, 'precision': 0.7825706310268989, 'precision_real': 0.9173151750972762, 'precision_fake': 0.6478260869565218, 'acc': 0.8680445151033387}
best model path: ./param_model/ARG-D_en-argd/1/parameter_bert.pkl
best macro f1: 0.7677619898107024
best_val_metric: {'auc': 0.8641293967849754, 'spauc': 0.7423708084471883, 'metric': 0.7677619898107024, 'f1_real': 0.9174224343675417, 'f1_fake': 0.6181015452538632, 'recall': 0.7533901002705714, 'recall_real': 0.933009708737864, 'recall_fake': 0.5737704918032787, 'precision': 0.7861019385852596, 'precision_real': 0.9023474178403755, 'precision_fake': 0.6698564593301436, 'acc': 0.8642072213500785}
the_test_metric: {'auc': 0.8629849425747862, 'spauc': 0.7577044323549258, 'metric': 0.7806723465752504, 'f1_real': 0.919103313840156, 'f1_fake': 0.6422413793103449, 'recall': 0.7788252871260684, 'recall_real': 0.9208984375, 'recall_fake': 0.6367521367521367, 'precision': 0.7825706310268989, 'precision_real': 0.9173151750972762, 'precision_fake': 0.6478260869565218, 'acc': 0.8680445151033387}
