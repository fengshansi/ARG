lr: 5e-05; model name: SLM; batchsize: 64; epoch: 50; gpu: 1;
data_type: rationale; data_path: /home/tzh/ARG/data/en; data_name: en-SLM;
before in config
{'use_cuda': True, 'seed': 0, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'en', 'root_path': '/home/tzh/ARG/data/en', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.0, 'rationale_usefulness_evaluator_weight': 1.5, 'kd_loss_weight': 1}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 5e-05, 'epoch': 50, 'model_name': 'SLM', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/bert-base-uncased', 'data_type': 'rationale', 'data_name': 'en-SLM', 'eval_mode': False, 'teacher_path': None, 'month': 1, 'eval_model_path': ''}
{'lr': [5e-05]}



==================== start training ====================
----- model initiating finish -----
time cost in model and data loading: 59.372345209121704s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.8468068597803595, 'spauc': 0.7148843579584007, 'metric': 0.7452092651176321, 'f1_real': 0.9176029962546817, 'f1_fake': 0.5728155339805825, 'recall': 0.7175314340283304, 'recall_real': 0.9514563106796117, 'recall_fake': 0.48360655737704916, 'precision': 0.7942284508740205, 'precision_real': 0.8860759493670886, 'precision_fake': 0.7023809523809523, 'acc': 0.8618524332810047}
Max {'auc': 0.8468068597803595, 'spauc': 0.7148843579584007, 'metric': 0.7452092651176321, 'f1_real': 0.9176029962546817, 'f1_fake': 0.5728155339805825, 'recall': 0.7175314340283304, 'recall_real': 0.9514563106796117, 'recall_fake': 0.48360655737704916, 'precision': 0.7942284508740205, 'precision_real': 0.8860759493670886, 'precision_fake': 0.7023809523809523, 'acc': 0.8618524332810047}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8528171255769537, 'spauc': 0.7292820225001466, 'metric': 0.7581684138336435, 'f1_real': 0.9104046242774566, 'f1_fake': 0.6059322033898306, 'recall': 0.7517706509629158, 'recall_real': 0.9174757281553398, 'recall_fake': 0.5860655737704918, 'precision': 0.7653173325282614, 'precision_real': 0.9034416826003824, 'precision_fake': 0.6271929824561403, 'acc': 0.8540031397174255}
Max {'auc': 0.8528171255769537, 'spauc': 0.7292820225001466, 'metric': 0.7581684138336435, 'f1_real': 0.9104046242774566, 'f1_fake': 0.6059322033898306, 'recall': 0.7517706509629158, 'recall_real': 0.9174757281553398, 'recall_fake': 0.5860655737704918, 'precision': 0.7653173325282614, 'precision_real': 0.9034416826003824, 'precision_fake': 0.6271929824561403, 'acc': 0.8540031397174255}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.8524590163934425, 'spauc': 0.7292820225001466, 'metric': 0.7451609142506519, 'f1_real': 0.9249884951679704, 'f1_fake': 0.5653333333333334, 'recall': 0.7050771924240012, 'recall_real': 0.9757281553398058, 'recall_fake': 0.4344262295081967, 'precision': 0.8442126986035143, 'precision_real': 0.8792650918635171, 'precision_fake': 0.8091603053435115, 'acc': 0.8720565149136578}
Max {'auc': 0.8528171255769537, 'spauc': 0.7292820225001466, 'metric': 0.7581684138336435, 'f1_real': 0.9104046242774566, 'f1_fake': 0.6059322033898306, 'recall': 0.7517706509629158, 'recall_real': 0.9174757281553398, 'recall_fake': 0.5860655737704918, 'precision': 0.7653173325282614, 'precision_real': 0.9034416826003824, 'precision_fake': 0.6271929824561403, 'acc': 0.8540031397174255}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.8591715740888113, 'spauc': 0.7336798545783526, 'metric': 0.7581078025199148, 'f1_real': 0.9153187440532825, 'f1_fake': 0.6008968609865472, 'recall': 0.7415804551965621, 'recall_real': 0.9339805825242719, 'recall_fake': 0.5491803278688525, 'precision': 0.780377198167578, 'precision_real': 0.8973880597014925, 'precision_fake': 0.6633663366336634, 'acc': 0.8602825745682888}
Max {'auc': 0.8528171255769537, 'spauc': 0.7292820225001466, 'metric': 0.7581684138336435, 'f1_real': 0.9104046242774566, 'f1_fake': 0.6059322033898306, 'recall': 0.7517706509629158, 'recall_real': 0.9174757281553398, 'recall_fake': 0.5860655737704918, 'precision': 0.7653173325282614, 'precision_real': 0.9034416826003824, 'precision_fake': 0.6271929824561403, 'acc': 0.8540031397174255}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.8565693140219641, 'spauc': 0.7323814470124062, 'metric': 0.7490865626230934, 'f1_real': 0.9184629803186504, 'f1_fake': 0.5797101449275363, 'recall': 0.7216297946840682, 'recall_real': 0.9514563106796117, 'recall_fake': 0.4918032786885246, 'precision': 0.7967817561807331, 'precision_real': 0.8876811594202898, 'precision_fake': 0.7058823529411765, 'acc': 0.8634222919937206}
Max {'auc': 0.8528171255769537, 'spauc': 0.7292820225001466, 'metric': 0.7581684138336435, 'f1_real': 0.9104046242774566, 'f1_fake': 0.6059322033898306, 'recall': 0.7517706509629158, 'recall_real': 0.9174757281553398, 'recall_fake': 0.5860655737704918, 'precision': 0.7653173325282614, 'precision_real': 0.9034416826003824, 'precision_fake': 0.6271929824561403, 'acc': 0.8540031397174255}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}
Max {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.8498289033901004, 'spauc': 0.7316065908843412, 'metric': 0.7599767067447676, 'f1_real': 0.9163498098859316, 'f1_fake': 0.6036036036036037, 'recall': 0.7425513289829699, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5491803278688525, 'precision': 0.7837895716945997, 'precision_real': 0.8975791433891993, 'precision_fake': 0.67, 'acc': 0.8618524332810047}
Max {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}

---------- epoch 7 ----------
----- in val progress... -----
current {'auc': 0.8443299379277416, 'spauc': 0.728213977566868, 'metric': 0.7510980729187229, 'f1_real': 0.9068083051665861, 'f1_fake': 0.5953878406708596, 'recall': 0.7468088492758236, 'recall_real': 0.9116504854368932, 'recall_fake': 0.5819672131147541, 'precision': 0.7557296755760596, 'precision_real': 0.9020172910662824, 'precision_fake': 0.6094420600858369, 'acc': 0.8485086342229199}
Max {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}

---------- epoch 8 ----------
----- in val progress... -----
current {'auc': 0.8356438007321343, 'spauc': 0.726015061527765, 'metric': 0.7488305877567623, 'f1_real': 0.9089165867689358, 'f1_fake': 0.5887445887445888, 'recall': 0.7388826993474454, 'recall_real': 0.920388349514563, 'recall_fake': 0.5573770491803278, 'precision': 0.7607902418682235, 'precision_real': 0.8977272727272727, 'precision_fake': 0.6238532110091743, 'acc': 0.8508634222919937}
Max {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}

---------- epoch 9 ----------
----- in val progress... -----
current {'auc': 0.8253262772560879, 'spauc': 0.7224339696926544, 'metric': 0.7335549489256781, 'f1_real': 0.8862275449101796, 'f1_fake': 0.5808823529411764, 'recall': 0.7548384529683272, 'recall_real': 0.8621359223300971, 'recall_fake': 0.6475409836065574, 'precision': 0.7191854893908282, 'precision_real': 0.9117043121149897, 'precision_fake': 0.5266666666666666, 'acc': 0.8210361067503925}
Max {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}

---------- epoch 10 ----------
----- in val progress... -----
current {'auc': 0.8063942384211363, 'spauc': 0.7239836819487842, 'metric': 0.7452556760790425, 'f1_real': 0.9068203650336215, 'f1_fake': 0.5836909871244635, 'recall': 0.7369409517746299, 'recall_real': 0.916504854368932, 'recall_fake': 0.5573770491803278, 'precision': 0.7549755078272189, 'precision_real': 0.8973384030418251, 'precision_fake': 0.6126126126126126, 'acc': 0.847723704866562}
Max {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}

test results: {'auc': 0.8572382478632479, 'spauc': 0.751664066014395, 'metric': 0.7753873428782685, 'f1_real': 0.9171539961013646, 'f1_fake': 0.6336206896551724, 'recall': 0.7735752203525641, 'recall_real': 0.9189453125, 'recall_fake': 0.6282051282051282, 'precision': 0.777250042294028, 'precision_real': 0.9153696498054474, 'precision_fake': 0.6391304347826087, 'acc': 0.8648648648648649}
best model path: ./param_model/SLM_en-SLM/1/parameter_bert.pkl
best macro f1: 0.764283166047715
best_val_metric: {'auc': 0.8595416202451059, 'spauc': 0.7372818884709785, 'metric': 0.764283166047715, 'f1_real': 0.9128550794415021, 'f1_fake': 0.6157112526539278, 'recall': 0.7573253222982652, 'recall_real': 0.920388349514563, 'recall_fake': 0.5942622950819673, 'precision': 0.7721053229491435, 'precision_real': 0.9054441260744985, 'precision_fake': 0.6387665198237885, 'acc': 0.8579277864992151}
the_test_metric: {'auc': 0.8572382478632479, 'spauc': 0.751664066014395, 'metric': 0.7753873428782685, 'f1_real': 0.9171539961013646, 'f1_fake': 0.6336206896551724, 'recall': 0.7735752203525641, 'recall_real': 0.9189453125, 'recall_fake': 0.6282051282051282, 'precision': 0.777250042294028, 'precision_real': 0.9153696498054474, 'precision_fake': 0.6391304347826087, 'acc': 0.8648648648648649}
lr: 5e-05; model name: SLM; batchsize: 64; epoch: 50; gpu: 1;
data_type: rationale; data_path: /home/tzh/ARG/data/en; data_name: en-SLM;
before in config
{'use_cuda': True, 'seed': 1, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'en', 'root_path': '/home/tzh/ARG/data/en', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.0, 'rationale_usefulness_evaluator_weight': 1.5, 'kd_loss_weight': 1}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 5e-05, 'epoch': 50, 'model_name': 'SLM', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/bert-base-uncased', 'data_type': 'rationale', 'data_name': 'en-SLM', 'eval_mode': False, 'teacher_path': None, 'month': 1, 'eval_model_path': ''}
{'lr': [5e-05]}



==================== start training ====================
----- model initiating finish -----
time cost in model and data loading: 59.55097246170044s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.8412820308769696, 'spauc': 0.7192088928353033, 'metric': 0.7569395525141727, 'f1_real': 0.9130019120458891, 'f1_fake': 0.6008771929824561, 'recall': 0.7443299379277415, 'recall_real': 0.9271844660194175, 'recall_fake': 0.5614754098360656, 'precision': 0.7727365597128948, 'precision_real': 0.89924670433145, 'precision_fake': 0.6462264150943396, 'acc': 0.8571428571428571}
Max {'auc': 0.8412820308769696, 'spauc': 0.7192088928353033, 'metric': 0.7569395525141727, 'f1_real': 0.9130019120458891, 'f1_fake': 0.6008771929824561, 'recall': 0.7443299379277415, 'recall_real': 0.9271844660194175, 'recall_fake': 0.5614754098360656, 'precision': 0.7727365597128948, 'precision_real': 0.89924670433145, 'precision_fake': 0.6462264150943396, 'acc': 0.8571428571428571}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8515717014165207, 'spauc': 0.7289469495799024, 'metric': 0.7584993828248987, 'f1_real': 0.918867924528302, 'f1_fake': 0.5981308411214953, 'recall': 0.7351106159477956, 'recall_real': 0.945631067961165, 'recall_fake': 0.5245901639344263, 'precision': 0.7946150777822099, 'precision_real': 0.8935779816513761, 'precision_fake': 0.6956521739130435, 'acc': 0.8649921507064364}
Max {'auc': 0.8515717014165207, 'spauc': 0.7289469495799024, 'metric': 0.7584993828248987, 'f1_real': 0.918867924528302, 'f1_fake': 0.5981308411214953, 'recall': 0.7351106159477956, 'recall_real': 0.945631067961165, 'recall_fake': 0.5245901639344263, 'precision': 0.7946150777822099, 'precision_real': 0.8935779816513761, 'precision_fake': 0.6956521739130435, 'acc': 0.8649921507064364}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.8577590323094063, 'spauc': 0.7328840563927725, 'metric': 0.7506991707324837, 'f1_real': 0.8964834076275384, 'f1_fake': 0.6049149338374291, 'recall': 0.767189240808531, 'recall_real': 0.8786407766990292, 'recall_fake': 0.6557377049180327, 'precision': 0.7382346158622035, 'precision_real': 0.9150657229524772, 'precision_fake': 0.5614035087719298, 'acc': 0.8359497645211931}
Max {'auc': 0.8515717014165207, 'spauc': 0.7289469495799024, 'metric': 0.7584993828248987, 'f1_real': 0.918867924528302, 'f1_fake': 0.5981308411214953, 'recall': 0.7351106159477956, 'recall_real': 0.945631067961165, 'recall_fake': 0.5245901639344263, 'precision': 0.7946150777822099, 'precision_real': 0.8935779816513761, 'precision_fake': 0.6956521739130435, 'acc': 0.8649921507064364}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.8575680407448671, 'spauc': 0.7310830394464596, 'metric': 0.7393014411795189, 'f1_real': 0.8831562974203337, 'f1_fake': 0.595446584938704, 'recall': 0.7721470635046952, 'recall_real': 0.8475728155339806, 'recall_fake': 0.6967213114754098, 'precision': 0.7208680881844809, 'precision_real': 0.9218585005279831, 'precision_fake': 0.5198776758409785, 'acc': 0.8186813186813187}
Max {'auc': 0.8515717014165207, 'spauc': 0.7289469495799024, 'metric': 0.7584993828248987, 'f1_real': 0.918867924528302, 'f1_fake': 0.5981308411214953, 'recall': 0.7351106159477956, 'recall_real': 0.945631067961165, 'recall_fake': 0.5245901639344263, 'precision': 0.7946150777822099, 'precision_real': 0.8935779816513761, 'precision_fake': 0.6956521739130435, 'acc': 0.8649921507064364}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.8609780359700779, 'spauc': 0.7347897836266617, 'metric': 0.7621674274730902, 'f1_real': 0.9143130684538057, 'f1_fake': 0.6100217864923747, 'recall': 0.7504774789113481, 'recall_real': 0.9271844660194175, 'recall_fake': 0.5737704918032787, 'precision': 0.7764784680589412, 'precision_real': 0.9017941454202077, 'precision_fake': 0.6511627906976745, 'acc': 0.859497645211931}
Max {'auc': 0.8609780359700779, 'spauc': 0.7347897836266617, 'metric': 0.7621674274730902, 'f1_real': 0.9143130684538057, 'f1_fake': 0.6100217864923747, 'recall': 0.7504774789113481, 'recall_real': 0.9271844660194175, 'recall_fake': 0.5737704918032787, 'precision': 0.7764784680589412, 'precision_real': 0.9017941454202077, 'precision_fake': 0.6511627906976745, 'acc': 0.859497645211931}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8512096132420819, 'spauc': 0.7398158774303258, 'metric': 0.7625908709274465, 'f1_real': 0.9124157844080846, 'f1_fake': 0.6127659574468085, 'recall': 0.7552761419703963, 'recall_real': 0.920388349514563, 'recall_fake': 0.5901639344262295, 'precision': 0.770874147132338, 'precision_real': 0.9045801526717557, 'precision_fake': 0.6371681415929203, 'acc': 0.8571428571428571}
Max {'auc': 0.8512096132420819, 'spauc': 0.7398158774303258, 'metric': 0.7625908709274465, 'f1_real': 0.9124157844080846, 'f1_fake': 0.6127659574468085, 'recall': 0.7552761419703963, 'recall_real': 0.920388349514563, 'recall_fake': 0.5901639344262295, 'precision': 0.770874147132338, 'precision_real': 0.9045801526717557, 'precision_fake': 0.6371681415929203, 'acc': 0.8571428571428571}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.8524868693299379, 'spauc': 0.7432922589778601, 'metric': 0.7664234985332716, 'f1_real': 0.9068627450980392, 'f1_fake': 0.6259842519685039, 'recall': 0.7748487983447399, 'recall_real': 0.8980582524271845, 'recall_fake': 0.6516393442622951, 'precision': 0.7590571557155716, 'precision_real': 0.9158415841584159, 'precision_fake': 0.6022727272727273, 'acc': 0.8508634222919937}
Max {'auc': 0.8524868693299379, 'spauc': 0.7432922589778601, 'metric': 0.7664234985332716, 'f1_real': 0.9068627450980392, 'f1_fake': 0.6259842519685039, 'recall': 0.7748487983447399, 'recall_real': 0.8980582524271845, 'recall_fake': 0.6516393442622951, 'precision': 0.7590571557155716, 'precision_real': 0.9158415841584159, 'precision_fake': 0.6022727272727273, 'acc': 0.8508634222919937}

---------- epoch 7 ----------
----- in val progress... -----
current {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}
Max {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}

---------- epoch 8 ----------
----- in val progress... -----
current {'auc': 0.8452570428139424, 'spauc': 0.7381614548866198, 'metric': 0.7605767099131582, 'f1_real': 0.9216330361332707, 'f1_fake': 0.5995203836930456, 'recall': 0.7328465701098201, 'recall_real': 0.9533980582524272, 'recall_fake': 0.5122950819672131, 'precision': 0.8072298961007597, 'precision_real': 0.8919164396003633, 'precision_fake': 0.7225433526011561, 'acc': 0.868916797488226}
Max {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}

---------- epoch 9 ----------
----- in val progress... -----
current {'auc': 0.8434983288238104, 'spauc': 0.744548782428776, 'metric': 0.7653487229862475, 'f1_real': 0.905697445972495, 'f1_fake': 0.625, 'recall': 0.775441667992997, 'recall_real': 0.8951456310679612, 'recall_fake': 0.6557377049180327, 'precision': 0.7567579597044598, 'precision_real': 0.9165009940357853, 'precision_fake': 0.5970149253731343, 'acc': 0.8492935635792779}
Max {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}

---------- epoch 10 ----------
----- in val progress... -----
current {'auc': 0.8343904185898456, 'spauc': 0.7359625388475167, 'metric': 0.7559664694280078, 'f1_real': 0.9003944773175542, 'f1_fake': 0.6115384615384615, 'recall': 0.7690235556262932, 'recall_real': 0.8864077669902912, 'recall_fake': 0.6516393442622951, 'precision': 0.7454583079201882, 'precision_real': 0.9148296593186372, 'precision_fake': 0.5760869565217391, 'acc': 0.8414442700156985}
Max {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}

---------- epoch 11 ----------
----- in val progress... -----
current {'auc': 0.818947954798663, 'spauc': 0.7324023890699214, 'metric': 0.720866449312366, 'f1_real': 0.872264631043257, 'f1_fake': 0.5694682675814751, 'recall': 0.7561833519019576, 'recall_real': 0.8320388349514564, 'recall_fake': 0.680327868852459, 'precision': 0.7031265281655703, 'precision_real': 0.9165775401069519, 'precision_fake': 0.4896755162241888, 'acc': 0.8029827315541601}
Max {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}

---------- epoch 12 ----------
----- in val progress... -----
current {'auc': 0.8216576476205633, 'spauc': 0.7369886996657647, 'metric': 0.751391888346419, 'f1_real': 0.8963807635101636, 'f1_fake': 0.6064030131826743, 'recall': 0.7687529842431959, 'recall_real': 0.8776699029126214, 'recall_fake': 0.6598360655737705, 'precision': 0.7384411990016557, 'precision_real': 0.9159067882472138, 'precision_fake': 0.5609756097560976, 'acc': 0.8359497645211931}
Max {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}

test results: {'auc': 0.8446472689636753, 'spauc': 0.7338197255960414, 'metric': 0.767667131109472, 'f1_real': 0.91855421686747, 'f1_fake': 0.616780045351474, 'recall': 0.7559303218482907, 'recall_real': 0.9306640625, 'recall_fake': 0.5811965811965812, 'precision': 0.7818801509489468, 'precision_real': 0.9067554709800191, 'precision_fake': 0.6570048309178744, 'acc': 0.8656597774244833}
best model path: ./param_model/SLM_en-SLM/1/parameter_bert.pkl
best macro f1: 0.7764024989030736
best_val_metric: {'auc': 0.8515518064618813, 'spauc': 0.7420566775844594, 'metric': 0.7764024989030736, 'f1_real': 0.9196172248803828, 'f1_fake': 0.6331877729257642, 'recall': 0.7636360019099157, 'recall_real': 0.933009708737864, 'recall_fake': 0.5942622950819673, 'precision': 0.7920869335214248, 'precision_real': 0.9066037735849056, 'precision_fake': 0.677570093457944, 'acc': 0.8681318681318682}
the_test_metric: {'auc': 0.8446472689636753, 'spauc': 0.7338197255960414, 'metric': 0.767667131109472, 'f1_real': 0.91855421686747, 'f1_fake': 0.616780045351474, 'recall': 0.7559303218482907, 'recall_real': 0.9306640625, 'recall_fake': 0.5811965811965812, 'precision': 0.7818801509489468, 'precision_real': 0.9067554709800191, 'precision_fake': 0.6570048309178744, 'acc': 0.8656597774244833}
lr: 5e-05; model name: SLM; batchsize: 64; epoch: 50; gpu: 1;
data_type: rationale; data_path: /home/tzh/ARG/data/en; data_name: en-SLM;
before in config
{'use_cuda': True, 'seed': 2, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'en', 'root_path': '/home/tzh/ARG/data/en', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.0, 'rationale_usefulness_evaluator_weight': 1.5, 'kd_loss_weight': 1}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 5e-05, 'epoch': 50, 'model_name': 'SLM', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/bert-base-uncased', 'data_type': 'rationale', 'data_name': 'en-SLM', 'eval_mode': False, 'teacher_path': None, 'month': 1, 'eval_model_path': ''}
{'lr': [5e-05]}



==================== start training ====================
----- model initiating finish -----
time cost in model and data loading: 59.38972783088684s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.8448432277574408, 'spauc': 0.7226643323253223, 'metric': 0.7450980392156863, 'f1_real': 0.9187675070028011, 'f1_fake': 0.5714285714285714, 'recall': 0.7153748209454083, 'recall_real': 0.9553398058252427, 'recall_fake': 0.47540983606557374, 'precision': 0.8004707345234923, 'precision_real': 0.8848920863309353, 'precision_fake': 0.7160493827160493, 'acc': 0.8634222919937206}
Max {'auc': 0.8448432277574408, 'spauc': 0.7226643323253223, 'metric': 0.7450980392156863, 'f1_real': 0.9187675070028011, 'f1_fake': 0.5714285714285714, 'recall': 0.7153748209454083, 'recall_real': 0.9553398058252427, 'recall_fake': 0.47540983606557374, 'precision': 0.8004707345234923, 'precision_real': 0.8848920863309353, 'precision_fake': 0.7160493827160493, 'acc': 0.8634222919937206}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}
Max {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.856445965303199, 'spauc': 0.7293867327877229, 'metric': 0.7635655869758524, 'f1_real': 0.9237248479176415, 'f1_fake': 0.6034063260340632, 'recall': 0.7332245742479707, 'recall_real': 0.958252427184466, 'recall_fake': 0.5081967213114754, 'precision': 0.81705694302452, 'precision_real': 0.8915989159891599, 'precision_fake': 0.7425149700598802, 'acc': 0.8720565149136578}
Max {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.8543649530479069, 'spauc': 0.7296380374779061, 'metric': 0.7519021852526742, 'f1_real': 0.9217148182665423, 'f1_fake': 0.5820895522388059, 'recall': 0.7198511857392965, 'recall_real': 0.9601941747572815, 'recall_fake': 0.47950819672131145, 'precision': 0.813353522979901, 'precision_real': 0.8862007168458781, 'precision_fake': 0.740506329113924, 'acc': 0.8681318681318682}
Max {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.8496259748527775, 'spauc': 0.7239627398912689, 'metric': 0.7433184376259231, 'f1_real': 0.9165885660731022, 'f1_fake': 0.5700483091787439, 'recall': 0.7165605602419227, 'recall_real': 0.9495145631067962, 'recall_fake': 0.48360655737704916, 'precision': 0.7899936061381074, 'precision_real': 0.8858695652173914, 'precision_fake': 0.6941176470588235, 'acc': 0.8602825745682888}
Max {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8467292694572657, 'spauc': 0.72130309858683, 'metric': 0.7316354990213494, 'f1_real': 0.8830908178625186, 'f1_fake': 0.5801801801801801, 'recall': 0.7571024988063026, 'recall_real': 0.8543689320388349, 'recall_fake': 0.6598360655737705, 'precision': 0.7157479473643791, 'precision_real': 0.9138110072689511, 'precision_fake': 0.5176848874598071, 'acc': 0.8171114599686028}
Max {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.83622075441668, 'spauc': 0.7246119436742421, 'metric': 0.7557263583718933, 'f1_real': 0.9185115402731983, 'f1_fake': 0.5929411764705883, 'recall': 0.7314976921852618, 'recall_real': 0.9466019417475728, 'recall_fake': 0.5163934426229508, 'precision': 0.7940864264303731, 'precision_real': 0.8920402561756633, 'precision_fake': 0.6961325966850829, 'acc': 0.8642072213500785}
Max {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}

test results: {'auc': 0.8529563969017094, 'spauc': 0.7361040823211875, 'metric': 0.773005148005148, 'f1_real': 0.9198841698841699, 'f1_fake': 0.6261261261261261, 'recall': 0.7623405782585471, 'recall_real': 0.9306640625, 'recall_fake': 0.594017094017094, 'precision': 0.785627953471465, 'precision_real': 0.9093511450381679, 'precision_fake': 0.6619047619047619, 'acc': 0.8680445151033387}
best model path: ./param_model/SLM_en-SLM/1/parameter_bert.pkl
best macro f1: 0.7672089631184985
best_val_metric: {'auc': 0.8464785930288079, 'spauc': 0.7315228226542801, 'metric': 0.7672089631184985, 'f1_real': 0.9186875891583453, 'f1_fake': 0.6157303370786518, 'recall': 0.7496697437529842, 'recall_real': 0.9378640776699029, 'recall_fake': 0.5614754098360656, 'precision': 0.7909358148678787, 'precision_real': 0.9002795899347623, 'precision_fake': 0.681592039800995, 'acc': 0.8657770800627943}
the_test_metric: {'auc': 0.8529563969017094, 'spauc': 0.7361040823211875, 'metric': 0.773005148005148, 'f1_real': 0.9198841698841699, 'f1_fake': 0.6261261261261261, 'recall': 0.7623405782585471, 'recall_real': 0.9306640625, 'recall_fake': 0.594017094017094, 'precision': 0.785627953471465, 'precision_real': 0.9093511450381679, 'precision_fake': 0.6619047619047619, 'acc': 0.8680445151033387}
lr: 5e-05; model name: SLM; batchsize: 64; epoch: 50; gpu: 1;
data_type: rationale; data_path: /home/tzh/ARG/data/en; data_name: en-SLM;
before in config
{'use_cuda': True, 'seed': 3, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'en', 'root_path': '/home/tzh/ARG/data/en', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.0, 'rationale_usefulness_evaluator_weight': 1.5, 'kd_loss_weight': 1}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 5e-05, 'epoch': 50, 'model_name': 'SLM', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/bert-base-uncased', 'data_type': 'rationale', 'data_name': 'en-SLM', 'eval_mode': False, 'teacher_path': None, 'month': 1, 'eval_model_path': ''}
{'lr': [5e-05]}



==================== start training ====================
----- model initiating finish -----
time cost in model and data loading: 59.411725997924805s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.8480940633455355, 'spauc': 0.7163398309557117, 'metric': 0.7500749426908835, 'f1_real': 0.9160377358490566, 'f1_fake': 0.5841121495327104, 'recall': 0.7275067642845774, 'recall_real': 0.9427184466019417, 'recall_fake': 0.5122950819672131, 'precision': 0.7850867570801755, 'precision_real': 0.8908256880733945, 'precision_fake': 0.6793478260869565, 'acc': 0.8602825745682888}
Max {'auc': 0.8480940633455355, 'spauc': 0.7163398309557117, 'metric': 0.7500749426908835, 'f1_real': 0.9160377358490566, 'f1_fake': 0.5841121495327104, 'recall': 0.7275067642845774, 'recall_real': 0.9427184466019417, 'recall_fake': 0.5122950819672131, 'precision': 0.7850867570801755, 'precision_real': 0.8908256880733945, 'precision_fake': 0.6793478260869565, 'acc': 0.8602825745682888}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8578744230463154, 'spauc': 0.7288212972348107, 'metric': 0.7627885571352788, 'f1_real': 0.9260808926080892, 'f1_fake': 0.5994962216624685, 'recall': 0.7273476046474614, 'recall_real': 0.9669902912621359, 'recall_fake': 0.48770491803278687, 'precision': 0.8331350976310834, 'precision_real': 0.8884924174843889, 'precision_fake': 0.7777777777777778, 'acc': 0.8751962323390895}
Max {'auc': 0.8578744230463154, 'spauc': 0.7288212972348107, 'metric': 0.7627885571352788, 'f1_real': 0.9260808926080892, 'f1_fake': 0.5994962216624685, 'recall': 0.7273476046474614, 'recall_real': 0.9669902912621359, 'recall_fake': 0.48770491803278687, 'precision': 0.8331350976310834, 'precision_real': 0.8884924174843889, 'precision_fake': 0.7777777777777778, 'acc': 0.8751962323390895}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.860659716695846, 'spauc': 0.7254705680323681, 'metric': 0.74542734563251, 'f1_real': 0.9110794103661436, 'f1_fake': 0.5797752808988764, 'recall': 0.7293928059844024, 'recall_real': 0.9300970873786408, 'recall_fake': 0.5286885245901639, 'precision': 0.7673074515586096, 'precision_real': 0.8928238583410997, 'precision_fake': 0.6417910447761194, 'acc': 0.8532182103610675}
Max {'auc': 0.8578744230463154, 'spauc': 0.7288212972348107, 'metric': 0.7627885571352788, 'f1_real': 0.9260808926080892, 'f1_fake': 0.5994962216624685, 'recall': 0.7273476046474614, 'recall_real': 0.9669902912621359, 'recall_fake': 0.48770491803278687, 'precision': 0.8331350976310834, 'precision_real': 0.8884924174843889, 'precision_fake': 0.7777777777777778, 'acc': 0.8751962323390895}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.8650962915804553, 'spauc': 0.7294495589602688, 'metric': 0.7603996473699677, 'f1_real': 0.9063414634146342, 'f1_fake': 0.6144578313253012, 'recall': 0.7644954639503422, 'recall_real': 0.9019417475728155, 'recall_fake': 0.6270491803278688, 'precision': 0.7565732592249499, 'precision_real': 0.9107843137254902, 'precision_fake': 0.6023622047244095, 'acc': 0.8492935635792779}
Max {'auc': 0.8578744230463154, 'spauc': 0.7288212972348107, 'metric': 0.7627885571352788, 'f1_real': 0.9260808926080892, 'f1_fake': 0.5994962216624685, 'recall': 0.7273476046474614, 'recall_real': 0.9669902912621359, 'recall_fake': 0.48770491803278687, 'precision': 0.8331350976310834, 'precision_real': 0.8884924174843889, 'precision_fake': 0.7777777777777778, 'acc': 0.8751962323390895}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}
Max {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8612207544166799, 'spauc': 0.7351039144893907, 'metric': 0.7544017478473205, 'f1_real': 0.903225806451613, 'f1_fake': 0.605577689243028, 'recall': 0.7600190991564539, 'recall_real': 0.8970873786407767, 'recall_fake': 0.6229508196721312, 'precision': 0.7492980528596717, 'precision_real': 0.9094488188976378, 'precision_fake': 0.5891472868217055, 'acc': 0.8445839874411303}
Max {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.8585707464586982, 'spauc': 0.7333657237156236, 'metric': 0.7590721464731724, 'f1_real': 0.9071463296062227, 'f1_fake': 0.6109979633401221, 'recall': 0.7602896705395512, 'recall_real': 0.9058252427184466, 'recall_fake': 0.6147540983606558, 'precision': 0.7578793624762978, 'precision_real': 0.9084712755598832, 'precision_fake': 0.6072874493927125, 'acc': 0.8500784929356358}
Max {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}

---------- epoch 7 ----------
----- in val progress... -----
current {'auc': 0.8322934903708419, 'spauc': 0.7300568786282114, 'metric': 0.7557733455100965, 'f1_real': 0.9254284390921723, 'f1_fake': 0.5861182519280206, 'recall': 0.7185580136877288, 'recall_real': 0.9699029126213592, 'recall_fake': 0.4672131147540984, 'precision': 0.8355303747594759, 'precision_real': 0.8848538529672276, 'precision_fake': 0.7862068965517242, 'acc': 0.8736263736263736}
Max {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}

---------- epoch 8 ----------
----- in val progress... -----
current {'auc': 0.8439718287442305, 'spauc': 0.7332610134280473, 'metric': 0.7568009754586204, 'f1_real': 0.9074163839069315, 'f1_fake': 0.6061855670103092, 'recall': 0.7555984402355562, 'recall_real': 0.9087378640776699, 'recall_fake': 0.6024590163934426, 'precision': 0.758028623876796, 'precision_real': 0.9060987415295256, 'precision_fake': 0.6099585062240664, 'acc': 0.8500784929356358}
Max {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}

---------- epoch 9 ----------
----- in val progress... -----
current {'auc': 0.820756406175394, 'spauc': 0.718276971275874, 'metric': 0.7518325159521173, 'f1_real': 0.9140958709065022, 'f1_fake': 0.5895691609977324, 'recall': 0.7338691707782907, 'recall_real': 0.9349514563106797, 'recall_fake': 0.5327868852459017, 'precision': 0.7770244474923292, 'precision_real': 0.8941504178272981, 'precision_fake': 0.6598984771573604, 'acc': 0.8579277864992151}
Max {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}

test results: {'auc': 0.8511076055021367, 'spauc': 0.7492874564215024, 'metric': 0.7798382649641231, 'f1_real': 0.9235209235209234, 'f1_fake': 0.6361556064073227, 'recall': 0.7657585470085471, 'recall_real': 0.9375, 'recall_fake': 0.594017094017094, 'precision': 0.79734083533724, 'precision_real': 0.909952606635071, 'precision_fake': 0.6847290640394089, 'acc': 0.8736089030206677}
best model path: ./param_model/SLM_en-SLM/1/parameter_bert.pkl
best macro f1: 0.7673314339981007
best_val_metric: {'auc': 0.8554193856438006, 'spauc': 0.7363185538252762, 'metric': 0.7673314339981007, 'f1_real': 0.919278252611586, 'f1_fake': 0.6153846153846153, 'recall': 0.7485914372115232, 'recall_real': 0.9398058252427185, 'recall_fake': 0.5573770491803278, 'precision': 0.7932484698283955, 'precision_real': 0.8996282527881041, 'precision_fake': 0.6868686868686869, 'acc': 0.8665620094191523}
the_test_metric: {'auc': 0.8511076055021367, 'spauc': 0.7492874564215024, 'metric': 0.7798382649641231, 'f1_real': 0.9235209235209234, 'f1_fake': 0.6361556064073227, 'recall': 0.7657585470085471, 'recall_real': 0.9375, 'recall_fake': 0.594017094017094, 'precision': 0.79734083533724, 'precision_real': 0.909952606635071, 'precision_fake': 0.6847290640394089, 'acc': 0.8736089030206677}
lr: 5e-05; model name: SLM; batchsize: 64; epoch: 50; gpu: 1;
data_type: rationale; data_path: /home/tzh/ARG/data/en; data_name: en-SLM;
before in config
{'use_cuda': True, 'seed': 4, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'en', 'root_path': '/home/tzh/ARG/data/en', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.0, 'rationale_usefulness_evaluator_weight': 1.5, 'kd_loss_weight': 1}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 5e-05, 'epoch': 50, 'model_name': 'SLM', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/bert-base-uncased', 'data_type': 'rationale', 'data_name': 'en-SLM', 'eval_mode': False, 'teacher_path': None, 'month': 1, 'eval_model_path': ''}
{'lr': [5e-05]}



==================== start training ====================
----- model initiating finish -----
time cost in model and data loading: 58.95678687095642s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.8407647620563425, 'spauc': 0.7177010646942041, 'metric': 0.7377605246297064, 'f1_real': 0.8956393924546792, 'f1_fake': 0.5798816568047337, 'recall': 0.7449188285850707, 'recall_real': 0.887378640776699, 'recall_fake': 0.6024590163934426, 'precision': 0.7314953759595025, 'precision_real': 0.904055390702275, 'precision_fake': 0.55893536121673, 'acc': 0.8328100470957613}
Max {'auc': 0.8407647620563425, 'spauc': 0.7177010646942041, 'metric': 0.7377605246297064, 'f1_real': 0.8956393924546792, 'f1_fake': 0.5798816568047337, 'recall': 0.7449188285850707, 'recall_real': 0.887378640776699, 'recall_fake': 0.6024590163934426, 'precision': 0.7314953759595025, 'precision_real': 0.904055390702275, 'precision_fake': 0.55893536121673, 'acc': 0.8328100470957613}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}
Max {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.857249721470635, 'spauc': 0.7358159444449098, 'metric': 0.7606228126174339, 'f1_real': 0.922211808809747, 'f1_fake': 0.5990338164251208, 'recall': 0.7317682635683591, 'recall_real': 0.9553398058252427, 'recall_fake': 0.5081967213114754, 'precision': 0.8103580562659847, 'precision_real': 0.8913043478260869, 'precision_fake': 0.7294117647058823, 'acc': 0.869701726844584}
Max {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.865104249562311, 'spauc': 0.7355646397547266, 'metric': 0.7475783726664318, 'f1_real': 0.8922155688622755, 'f1_fake': 0.6029411764705882, 'recall': 0.7700461562947636, 'recall_real': 0.8679611650485437, 'recall_fake': 0.6721311475409836, 'precision': 0.7322655715263517, 'precision_real': 0.917864476386037, 'precision_fake': 0.5466666666666666, 'acc': 0.8304552590266876}
Max {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.8559366544644279, 'spauc': 0.7417844308367608, 'metric': 0.7598184463360238, 'f1_real': 0.9262865090403339, 'f1_fake': 0.5933503836317136, 'recall': 0.7226563743434664, 'recall_real': 0.9699029126213592, 'recall_fake': 0.47540983606557374, 'precision': 0.8377698905649216, 'precision_real': 0.8864241348713399, 'precision_fake': 0.7891156462585034, 'acc': 0.8751962323390895}
Max {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8532587935699506, 'spauc': 0.7324023890699214, 'metric': 0.7591196022568572, 'f1_real': 0.9164292497625831, 'f1_fake': 0.6018099547511312, 'recall': 0.740987585548305, 'recall_real': 0.9368932038834952, 'recall_fake': 0.5450819672131147, 'precision': 0.7842786602080283, 'precision_real': 0.8968401486988847, 'precision_fake': 0.6717171717171717, 'acc': 0.8618524332810047}
Max {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.8491047270412222, 'spauc': 0.7329678246228335, 'metric': 0.7421744324970132, 'f1_real': 0.9235023041474655, 'f1_fake': 0.5608465608465608, 'recall': 0.7036208817443896, 'recall_real': 0.9728155339805825, 'recall_fake': 0.4344262295081967, 'precision': 0.8349960722702278, 'precision_real': 0.8789473684210526, 'precision_fake': 0.7910447761194029, 'acc': 0.869701726844584}
Max {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}

test results: {'auc': 0.8454527243589743, 'spauc': 0.7235489063202879, 'metric': 0.7657531695811677, 'f1_real': 0.9175108538350217, 'f1_fake': 0.6139954853273137, 'recall': 0.7549537593482907, 'recall_real': 0.9287109375, 'recall_fake': 0.5811965811965812, 'precision': 0.7786476981951369, 'precision_real': 0.9065776930409915, 'precision_fake': 0.6507177033492823, 'acc': 0.8640699523052464}
best model path: ./param_model/SLM_en-SLM/1/parameter_bert.pkl
best macro f1: 0.7635435822385683
best_val_metric: {'auc': 0.8529961801687093, 'spauc': 0.729700863650452, 'metric': 0.7635435822385683, 'f1_real': 0.9172216936251189, 'f1_fake': 0.6098654708520179, 'recall': 0.7466496896387076, 'recall_real': 0.9359223300970874, 'recall_fake': 0.5573770491803278, 'precision': 0.7862605290379785, 'precision_real': 0.8992537313432836, 'precision_fake': 0.6732673267326733, 'acc': 0.8634222919937206}
the_test_metric: {'auc': 0.8454527243589743, 'spauc': 0.7235489063202879, 'metric': 0.7657531695811677, 'f1_real': 0.9175108538350217, 'f1_fake': 0.6139954853273137, 'recall': 0.7549537593482907, 'recall_real': 0.9287109375, 'recall_fake': 0.5811965811965812, 'precision': 0.7786476981951369, 'precision_real': 0.9065776930409915, 'precision_fake': 0.6507177033492823, 'acc': 0.8640699523052464}
