lr: 0.0005; model name: ARG-D; batchsize: 64; epoch: 50; gpu: 1;
data_type: rationale; data_path: /home/tzh/ARG/data/zh; data_name: zh-argd;
before in config
{'use_cuda': True, 'seed': 3759, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'ch', 'root_path': '/home/tzh/ARG/data/zh', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.8, 'rationale_usefulness_evaluator_weight': 2.2, 'kd_loss_weight': 15.0}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 0.0005, 'epoch': 50, 'model_name': 'ARG-D', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/chinese-bert-wwm-ext', 'data_type': 'rationale', 'data_name': 'zh-argd', 'eval_mode': False, 'teacher_path': './param_model/ARG_zh-arg/1/parameter_bert.pkl', 'month': 1}
{'lr': [0.0005]}



==================== start training ====================
----- model initiating finish -----
time cost in model and data loading: 46.25724172592163s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.8624061871568959, 'spauc': 0.6370644636362316, 'metric': 0.7650752236307155, 'f1_real': 0.7714570858283434, 'f1_fake': 0.7586933614330874, 'recall': 0.7919090940954316, 'recall_real': 0.659556313993174, 'recall_fake': 0.9242618741976893, 'precision': 0.7862590869251391, 'precision_real': 0.9290865384615384, 'precision_fake': 0.6434316353887399, 'acc': 0.7652485904664275}
Max {'auc': 0.8624061871568959, 'spauc': 0.6370644636362316, 'metric': 0.7650752236307155, 'f1_real': 0.7714570858283434, 'f1_fake': 0.7586933614330874, 'recall': 0.7919090940954316, 'recall_real': 0.659556313993174, 'recall_fake': 0.9242618741976893, 'precision': 0.7862590869251391, 'precision_real': 0.9290865384615384, 'precision_fake': 0.6434316353887399, 'acc': 0.7652485904664275}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8448917181824952, 'spauc': 0.6082798574858769, 'metric': 0.7614197499209086, 'f1_real': 0.7690014903129657, 'f1_fake': 0.7538380095288514, 'recall': 0.7872009270658542, 'recall_real': 0.6604095563139932, 'recall_fake': 0.9139922978177151, 'precision': 0.7808871892106137, 'precision_real': 0.920332936979786, 'precision_fake': 0.6414414414414414, 'acc': 0.7616606868272681}
Max {'auc': 0.8624061871568959, 'spauc': 0.6370644636362316, 'metric': 0.7650752236307155, 'f1_real': 0.7714570858283434, 'f1_fake': 0.7586933614330874, 'recall': 0.7919090940954316, 'recall_real': 0.659556313993174, 'recall_fake': 0.9242618741976893, 'precision': 0.7862590869251391, 'precision_real': 0.9290865384615384, 'precision_fake': 0.6434316353887399, 'acc': 0.7652485904664275}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.8493249637454161, 'spauc': 0.6232665074516458, 'metric': 0.7651926361238655, 'f1_real': 0.7767464582315584, 'f1_fake': 0.7536388140161725, 'recall': 0.7878159406257257, 'recall_real': 0.6783276450511946, 'recall_fake': 0.8973042362002568, 'precision': 0.7790998406797663, 'precision_real': 0.9085714285714286, 'precision_fake': 0.6496282527881041, 'acc': 0.7657611481291645}
Max {'auc': 0.8493249637454161, 'spauc': 0.6232665074516458, 'metric': 0.7651926361238655, 'f1_real': 0.7767464582315584, 'f1_fake': 0.7536388140161725, 'recall': 0.7878159406257257, 'recall_real': 0.6783276450511946, 'recall_fake': 0.8973042362002568, 'precision': 0.7790998406797663, 'precision_real': 0.9085714285714286, 'precision_fake': 0.6496282527881041, 'acc': 0.7657611481291645}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.8354589545536195, 'spauc': 0.6015996520851257, 'metric': 0.7602321914222603, 'f1_real': 0.7869003690036901, 'f1_fake': 0.7335640138408304, 'recall': 0.772123510933331, 'recall_real': 0.7278156996587031, 'recall_fake': 0.8164313222079589, 'precision': 0.7611971445993397, 'precision_real': 0.856425702811245, 'precision_fake': 0.6659685863874345, 'acc': 0.7631983598154792}
Max {'auc': 0.8493249637454161, 'spauc': 0.6232665074516458, 'metric': 0.7651926361238655, 'f1_real': 0.7767464582315584, 'f1_fake': 0.7536388140161725, 'recall': 0.7878159406257257, 'recall_real': 0.6783276450511946, 'recall_fake': 0.8973042362002568, 'precision': 0.7790998406797663, 'precision_real': 0.9085714285714286, 'precision_fake': 0.6496282527881041, 'acc': 0.7657611481291645}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.8384721376403632, 'spauc': 0.5944029240714065, 'metric': 0.7681618111153939, 'f1_real': 0.8014343343792021, 'f1_fake': 0.7348892878515858, 'recall': 0.7754943109876582, 'recall_real': 0.7627986348122867, 'recall_fake': 0.7881899871630296, 'precision': 0.7662667208678973, 'precision_real': 0.8441926345609065, 'precision_fake': 0.6883408071748879, 'acc': 0.7729369554074833}
Max {'auc': 0.8384721376403632, 'spauc': 0.5944029240714065, 'metric': 0.7681618111153939, 'f1_real': 0.8014343343792021, 'f1_fake': 0.7348892878515858, 'recall': 0.7754943109876582, 'recall_real': 0.7627986348122867, 'recall_fake': 0.7881899871630296, 'precision': 0.7662667208678973, 'precision_real': 0.8441926345609065, 'precision_fake': 0.6883408071748879, 'acc': 0.7729369554074833}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8236849772395693, 'spauc': 0.6039949104075386, 'metric': 0.7390600619079337, 'f1_real': 0.7719617660446063, 'f1_fake': 0.7061583577712611, 'recall': 0.7481675553238378, 'recall_real': 0.7235494880546075, 'recall_fake': 0.772785622593068, 'precision': 0.7387125322657114, 'precision_real': 0.8273170731707317, 'precision_fake': 0.6501079913606912, 'acc': 0.743208610968734}
Max {'auc': 0.8384721376403632, 'spauc': 0.5944029240714065, 'metric': 0.7681618111153939, 'f1_real': 0.8014343343792021, 'f1_fake': 0.7348892878515858, 'recall': 0.7754943109876582, 'recall_real': 0.7627986348122867, 'recall_fake': 0.7881899871630296, 'precision': 0.7662667208678973, 'precision_real': 0.8441926345609065, 'precision_fake': 0.6883408071748879, 'acc': 0.7729369554074833}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.8455746406305449, 'spauc': 0.618161811315673, 'metric': 0.7631881702271384, 'f1_real': 0.7788461538461539, 'f1_fake': 0.747530186608123, 'recall': 0.7826619846043978, 'recall_real': 0.6911262798634812, 'recall_fake': 0.8741976893453145, 'precision': 0.7724973707663002, 'precision_real': 0.8920704845814978, 'precision_fake': 0.6529242569511026, 'acc': 0.7642234751409533}
Max {'auc': 0.8384721376403632, 'spauc': 0.5944029240714065, 'metric': 0.7681618111153939, 'f1_real': 0.8014343343792021, 'f1_fake': 0.7348892878515858, 'recall': 0.7754943109876582, 'recall_real': 0.7627986348122867, 'recall_fake': 0.7881899871630296, 'precision': 0.7662667208678973, 'precision_real': 0.8441926345609065, 'precision_fake': 0.6883408071748879, 'acc': 0.7729369554074833}

---------- epoch 7 ----------
----- in val progress... -----
current {'auc': 0.8456168098594943, 'spauc': 0.592498246936087, 'metric': 0.7684851833580004, 'f1_real': 0.777503700049334, 'f1_fake': 0.7594666666666667, 'recall': 0.7931736233115879, 'recall_real': 0.6723549488054608, 'recall_fake': 0.9139922978177151, 'precision': 0.7856362316984675, 'precision_real': 0.9216374269005848, 'precision_fake': 0.6496350364963503, 'acc': 0.7688364941055869}
Max {'auc': 0.8456168098594943, 'spauc': 0.592498246936087, 'metric': 0.7684851833580004, 'f1_real': 0.777503700049334, 'f1_fake': 0.7594666666666667, 'recall': 0.7931736233115879, 'recall_real': 0.6723549488054608, 'recall_fake': 0.9139922978177151, 'precision': 0.7856362316984675, 'precision_real': 0.9216374269005848, 'precision_fake': 0.6496350364963503, 'acc': 0.7688364941055869}

---------- epoch 8 ----------
----- in val progress... -----
current {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}
Max {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}

---------- epoch 9 ----------
----- in val progress... -----
current {'auc': 0.8515374791344466, 'spauc': 0.59072327693014, 'metric': 0.7749307361354072, 'f1_real': 0.8123076923076922, 'f1_fake': 0.7375537799631223, 'recall': 0.7793070664674673, 'recall_real': 0.78839590443686, 'recall_fake': 0.7702182284980744, 'precision': 0.772631245830411, 'precision_real': 0.8377153218495014, 'precision_fake': 0.7075471698113207, 'acc': 0.7811378780112763}
Max {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}

---------- epoch 10 ----------
----- in val progress... -----
current {'auc': 0.81514598220349, 'spauc': 0.6033769279955948, 'metric': 0.7338463459857241, 'f1_real': 0.78895966029724, 'f1_fake': 0.6787330316742082, 'recall': 0.7333015329883854, 'recall_real': 0.7926621160409556, 'recall_fake': 0.6739409499358151, 'precision': 0.7344426907227388, 'precision_real': 0.7852916314454776, 'precision_fake': 0.68359375, 'acc': 0.7452588416196823}
Max {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}

---------- epoch 11 ----------
----- in val progress... -----
current {'auc': 0.8274659688845856, 'spauc': 0.6139022291870787, 'metric': 0.7266613242621485, 'f1_real': 0.7786391042204995, 'f1_fake': 0.6746835443037975, 'recall': 0.7277707921681337, 'recall_real': 0.7713310580204779, 'recall_fake': 0.6842105263157895, 'precision': 0.7257525918688595, 'precision_real': 0.7860869565217391, 'precision_fake': 0.66541822721598, 'acc': 0.7365453613531522}
Max {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}

---------- epoch 12 ----------
----- in val progress... -----
current {'auc': 0.7889966790363072, 'spauc': 0.5733148507399533, 'metric': 0.6870443389056156, 'f1_real': 0.7646817248459958, 'f1_fake': 0.6094069529652352, 'recall': 0.6840905904568297, 'recall_real': 0.7943686006825939, 'recall_fake': 0.5738125802310655, 'precision': 0.6934215553591486, 'precision_real': 0.7371338083927158, 'precision_fake': 0.6497093023255814, 'acc': 0.7063044592516659}
Max {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}

---------- epoch 13 ----------
----- in val progress... -----
current {'auc': 0.8323345980451001, 'spauc': 0.5778938006448693, 'metric': 0.7587868946236955, 'f1_real': 0.7728813559322033, 'f1_fake': 0.7446924333151879, 'recall': 0.7794680762507284, 'recall_real': 0.6808873720136519, 'recall_fake': 0.8780487804878049, 'precision': 0.770059928407674, 'precision_real': 0.8936170212765957, 'precision_fake': 0.6465028355387523, 'acc': 0.7596104561763198}
Max {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}

test results: {'auc': 0.8418091274291801, 'spauc': 0.6129763349593929, 'metric': 0.7628136174014722, 'f1_real': 0.7774022211492033, 'f1_fake': 0.7482250136537412, 'recall': 0.7747634297766224, 'recall_real': 0.7080035180299032, 'recall_fake': 0.8415233415233415, 'precision': 0.767717012079446, 'precision_real': 0.8618843683083511, 'precision_fake': 0.6735496558505408, 'acc': 0.7637109174782163}
best model path: ./param_model/ARG-D_zh-argd/1/parameter_bert.pkl
best macro f1: 0.7838070121860699
best_val_metric: {'auc': 0.8516497478608701, 'spauc': 0.6107189279942112, 'metric': 0.7838070121860699, 'f1_real': 0.8043071161048689, 'f1_fake': 0.7633069082672707, 'recall': 0.7990734817982273, 'recall_real': 0.7329351535836177, 'recall_fake': 0.865211810012837, 'precision': 0.7869781222279677, 'precision_real': 0.8910788381742739, 'precision_fake': 0.6828774062816616, 'acc': 0.7857508969759098}
the_test_metric: {'auc': 0.8418091274291801, 'spauc': 0.6129763349593929, 'metric': 0.7628136174014722, 'f1_real': 0.7774022211492033, 'f1_fake': 0.7482250136537412, 'recall': 0.7747634297766224, 'recall_real': 0.7080035180299032, 'recall_fake': 0.8415233415233415, 'precision': 0.767717012079446, 'precision_real': 0.8618843683083511, 'precision_fake': 0.6735496558505408, 'acc': 0.7637109174782163}
