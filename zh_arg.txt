lr: 2e-05; model name: ARG; batchsize: 64; epoch: 50; gpu: 2;
data_type: rationale; data_path: /home/tzh/ARG/data/zh; data_name: zh-arg;
before in config
{'use_cuda': True, 'seed': 3759, 'batchsize': 64, 'max_len': 170, 'early_stop': 5, 'language': 'ch', 'root_path': '/home/tzh/ARG/data/zh', 'weight_decay': 5e-05, 'model': {'mlp': {'dims': [384], 'dropout': 0.2}, 'llm_judgment_predictor_weight': 1.8, 'rationale_usefulness_evaluator_weight': 2.2, 'kd_loss_weight': 1}, 'emb_dim': 768, 'co_attention_dim': 300, 'lr': 2e-05, 'epoch': 50, 'model_name': 'ARG', 'save_log_dir': './logs', 'save_param_dir': './param_model', 'param_log_dir': './logs/param', 'tensorboard_dir': './logs/tensorlog', 'bert_path': '/home/tzh/model/chinese-bert-wwm-ext', 'data_type': 'rationale', 'data_name': 'zh-arg', 'eval_mode': False, 'teacher_path': None, 'month': 1}
{'lr': [2e-05]}



==================== start training ====================
time cost in model and data loading: 39.77366304397583s
---------- epoch 0 ----------
----- in val progress... -----
current {'auc': 0.7107470196760527, 'spauc': 0.5682539667899019, 'metric': 0.41590444531621007, 'f1_real': 0.24675324675324678, 'f1_fake': 0.5850556438791733, 'recall': 0.5453527319088531, 'recall_real': 0.14590443686006827, 'recall_fake': 0.944801026957638, 'precision': 0.611392238202078, 'precision_real': 0.7990654205607477, 'precision_fake': 0.4237190558434082, 'acc': 0.4648898001025115}
Max {'auc': 0.7107470196760527, 'spauc': 0.5682539667899019, 'metric': 0.41590444531621007, 'f1_real': 0.24675324675324678, 'f1_fake': 0.5850556438791733, 'recall': 0.5453527319088531, 'recall_real': 0.14590443686006827, 'recall_fake': 0.944801026957638, 'precision': 0.611392238202078, 'precision_real': 0.7990654205607477, 'precision_fake': 0.4237190558434082, 'acc': 0.4648898001025115}

---------- epoch 1 ----------
----- in val progress... -----
current {'auc': 0.8174247635237264, 'spauc': 0.6043563609413901, 'metric': 0.7358652478533425, 'f1_real': 0.7492682926829268, 'f1_fake': 0.7224622030237581, 'recall': 0.7570417135822157, 'recall_real': 0.6552901023890785, 'recall_fake': 0.858793324775353, 'precision': 0.7491004082395175, 'precision_real': 0.8747152619589977, 'precision_fake': 0.6234855545200373, 'acc': 0.7365453613531522}
Max {'auc': 0.8174247635237264, 'spauc': 0.6043563609413901, 'metric': 0.7358652478533425, 'f1_real': 0.7492682926829268, 'f1_fake': 0.7224622030237581, 'recall': 0.7570417135822157, 'recall_real': 0.6552901023890785, 'recall_fake': 0.858793324775353, 'precision': 0.7491004082395175, 'precision_real': 0.8747152619589977, 'precision_fake': 0.6234855545200373, 'acc': 0.7365453613531522}

---------- epoch 2 ----------
----- in val progress... -----
current {'auc': 0.8346648586837944, 'spauc': 0.6034881878887899, 'metric': 0.7643094827130728, 'f1_real': 0.788470478847048, 'f1_fake': 0.7401484865790976, 'recall': 0.7776925874162639, 'recall_real': 0.7235494880546075, 'recall_fake': 0.8318356867779204, 'precision': 0.7664283282260811, 'precision_real': 0.8661899897854954, 'precision_fake': 0.6666666666666666, 'acc': 0.7667862634546386}
Max {'auc': 0.8346648586837944, 'spauc': 0.6034881878887899, 'metric': 0.7643094827130728, 'f1_real': 0.788470478847048, 'f1_fake': 0.7401484865790976, 'recall': 0.7776925874162639, 'recall_real': 0.7235494880546075, 'recall_fake': 0.8318356867779204, 'precision': 0.7664283282260811, 'precision_real': 0.8661899897854954, 'precision_fake': 0.6666666666666666, 'acc': 0.7667862634546386}

---------- epoch 3 ----------
----- in val progress... -----
current {'auc': 0.8416748084312171, 'spauc': 0.6134254834271183, 'metric': 0.7627644996341519, 'f1_real': 0.7813688212927756, 'f1_fake': 0.7441601779755282, 'recall': 0.7800792562443317, 'recall_real': 0.7013651877133106, 'recall_fake': 0.858793324775353, 'precision': 0.769250127407582, 'precision_real': 0.8819742489270386, 'precision_fake': 0.6565260058881256, 'acc': 0.7642234751409533}
Max {'auc': 0.8346648586837944, 'spauc': 0.6034881878887899, 'metric': 0.7643094827130728, 'f1_real': 0.788470478847048, 'f1_fake': 0.7401484865790976, 'recall': 0.7776925874162639, 'recall_real': 0.7235494880546075, 'recall_fake': 0.8318356867779204, 'precision': 0.7664283282260811, 'precision_real': 0.8661899897854954, 'precision_fake': 0.6666666666666666, 'acc': 0.7667862634546386}

---------- epoch 4 ----------
----- in val progress... -----
current {'auc': 0.860433543485785, 'spauc': 0.6475332701669221, 'metric': 0.7730202530466093, 'f1_real': 0.799080459770115, 'f1_fake': 0.7469600463231036, 'recall': 0.7847260862136194, 'recall_real': 0.7414675767918089, 'recall_fake': 0.82798459563543, 'precision': 0.7733902722213107, 'precision_real': 0.8664007976071785, 'precision_fake': 0.680379746835443, 'acc': 0.7760123013839056}
Max {'auc': 0.860433543485785, 'spauc': 0.6475332701669221, 'metric': 0.7730202530466093, 'f1_real': 0.799080459770115, 'f1_fake': 0.7469600463231036, 'recall': 0.7847260862136194, 'recall_real': 0.7414675767918089, 'recall_fake': 0.82798459563543, 'precision': 0.7733902722213107, 'precision_real': 0.8664007976071785, 'precision_fake': 0.680379746835443, 'acc': 0.7760123013839056}

---------- epoch 5 ----------
----- in val progress... -----
current {'auc': 0.8557637121188886, 'spauc': 0.6314887865016039, 'metric': 0.7709436651483579, 'f1_real': 0.7923112986404127, 'f1_fake': 0.7495760316563029, 'recall': 0.7860404517912613, 'recall_real': 0.7209897610921502, 'recall_fake': 0.8510911424903723, 'precision': 0.7744946867215338, 'precision_real': 0.8792924037460979, 'precision_fake': 0.6696969696969697, 'acc': 0.7729369554074833}
Max {'auc': 0.860433543485785, 'spauc': 0.6475332701669221, 'metric': 0.7730202530466093, 'f1_real': 0.799080459770115, 'f1_fake': 0.7469600463231036, 'recall': 0.7847260862136194, 'recall_real': 0.7414675767918089, 'recall_fake': 0.82798459563543, 'precision': 0.7733902722213107, 'precision_real': 0.8664007976071785, 'precision_fake': 0.680379746835443, 'acc': 0.7760123013839056}

---------- epoch 6 ----------
----- in val progress... -----
current {'auc': 0.869458306133268, 'spauc': 0.6529198631307311, 'metric': 0.7845130618517095, 'f1_real': 0.8111313868613139, 'f1_fake': 0.7578947368421053, 'recall': 0.7951840549930558, 'recall_real': 0.7585324232081911, 'recall_fake': 0.8318356867779204, 'precision': 0.783797203091763, 'precision_real': 0.8715686274509804, 'precision_fake': 0.6960257787325457, 'acc': 0.787801127626858}
Max {'auc': 0.869458306133268, 'spauc': 0.6529198631307311, 'metric': 0.7845130618517095, 'f1_real': 0.8111313868613139, 'f1_fake': 0.7578947368421053, 'recall': 0.7951840549930558, 'recall_real': 0.7585324232081911, 'recall_fake': 0.8318356867779204, 'precision': 0.783797203091763, 'precision_real': 0.8715686274509804, 'precision_fake': 0.6960257787325457, 'acc': 0.787801127626858}

---------- epoch 7 ----------
----- in val progress... -----
current {'auc': 0.8657726059926307, 'spauc': 0.644574794664967, 'metric': 0.7852083690914826, 'f1_real': 0.8063462435837612, 'f1_fake': 0.764070494599204, 'recall': 0.7999228905527783, 'recall_real': 0.7372013651877133, 'recall_fake': 0.8626444159178434, 'precision': 0.7877593055759894, 'precision_real': 0.8898043254376931, 'precision_fake': 0.6857142857142857, 'acc': 0.787288569964121}
Max {'auc': 0.8657726059926307, 'spauc': 0.644574794664967, 'metric': 0.7852083690914826, 'f1_real': 0.8063462435837612, 'f1_fake': 0.764070494599204, 'recall': 0.7999228905527783, 'recall_real': 0.7372013651877133, 'recall_fake': 0.8626444159178434, 'precision': 0.7877593055759894, 'precision_real': 0.8898043254376931, 'precision_fake': 0.6857142857142857, 'acc': 0.787288569964121}

---------- epoch 8 ----------
----- in val progress... -----
current {'auc': 0.8707398125714687, 'spauc': 0.6441505082328862, 'metric': 0.7890609597099882, 'f1_real': 0.8086303939962476, 'f1_fake': 0.7694915254237288, 'recall': 0.8048462849456948, 'recall_real': 0.735494880546075, 'recall_fake': 0.8741976893453145, 'precision': 0.7925506643121426, 'precision_real': 0.8979166666666667, 'precision_fake': 0.6871846619576185, 'acc': 0.7908764736032804}
Max {'auc': 0.8707398125714687, 'spauc': 0.6441505082328862, 'metric': 0.7890609597099882, 'f1_real': 0.8086303939962476, 'f1_fake': 0.7694915254237288, 'recall': 0.8048462849456948, 'recall_real': 0.735494880546075, 'recall_fake': 0.8741976893453145, 'precision': 0.7925506643121426, 'precision_real': 0.8979166666666667, 'precision_fake': 0.6871846619576185, 'acc': 0.7908764736032804}

---------- epoch 9 ----------
----- in val progress... -----
current {'auc': 0.8729369936954265, 'spauc': 0.6373826784602922, 'metric': 0.7886770606565074, 'f1_real': 0.8147810218978102, 'f1_fake': 0.7625730994152046, 'recall': 0.7994579337296875, 'recall_real': 0.7619453924914675, 'recall_fake': 0.8369704749679076, 'precision': 0.7879062151176259, 'precision_real': 0.8754901960784314, 'precision_fake': 0.7003222341568206, 'acc': 0.7919015889287545}
Max {'auc': 0.8707398125714687, 'spauc': 0.6441505082328862, 'metric': 0.7890609597099882, 'f1_real': 0.8086303939962476, 'f1_fake': 0.7694915254237288, 'recall': 0.8048462849456948, 'recall_real': 0.735494880546075, 'recall_fake': 0.8741976893453145, 'precision': 0.7925506643121426, 'precision_real': 0.8979166666666667, 'precision_fake': 0.6871846619576185, 'acc': 0.7908764736032804}

---------- epoch 10 ----------
----- in val progress... -----
current {'auc': 0.8712524151467489, 'spauc': 0.6425248455447503, 'metric': 0.7866061378358289, 'f1_real': 0.8083720930232559, 'f1_fake': 0.7648401826484019, 'recall': 0.8007722993073294, 'recall_real': 0.7414675767918089, 'recall_fake': 0.8600770218228498, 'precision': 0.7885700204078631, 'precision_real': 0.8885480572597138, 'precision_fake': 0.6885919835560124, 'acc': 0.7888262429523322}
Max {'auc': 0.8707398125714687, 'spauc': 0.6441505082328862, 'metric': 0.7890609597099882, 'f1_real': 0.8086303939962476, 'f1_fake': 0.7694915254237288, 'recall': 0.8048462849456948, 'recall_real': 0.735494880546075, 'recall_fake': 0.8741976893453145, 'precision': 0.7925506643121426, 'precision_real': 0.8979166666666667, 'precision_fake': 0.6871846619576185, 'acc': 0.7908764736032804}

---------- epoch 11 ----------
----- in val progress... -----
current {'auc': 0.8693520615824086, 'spauc': 0.6337278197926393, 'metric': 0.7892460701780526, 'f1_real': 0.8129032258064517, 'f1_fake': 0.7655889145496535, 'recall': 0.8018254347264149, 'recall_real': 0.7525597269624573, 'recall_fake': 0.8510911424903723, 'precision': 0.7897326657512296, 'precision_real': 0.8837675350701403, 'precision_fake': 0.695697796432319, 'acc': 0.7919015889287545}
Max {'auc': 0.8693520615824086, 'spauc': 0.6337278197926393, 'metric': 0.7892460701780526, 'f1_real': 0.8129032258064517, 'f1_fake': 0.7655889145496535, 'recall': 0.8018254347264149, 'recall_real': 0.7525597269624573, 'recall_fake': 0.8510911424903723, 'precision': 0.7897326657512296, 'precision_real': 0.8837675350701403, 'precision_fake': 0.695697796432319, 'acc': 0.7919015889287545}

---------- epoch 12 ----------
----- in val progress... -----
current {'auc': 0.8743477460820952, 'spauc': 0.6401589875049951, 'metric': 0.7972544229113382, 'f1_real': 0.8164794007490638, 'f1_fake': 0.7780294450736126, 'recall': 0.8129635876922807, 'recall_real': 0.7440273037542662, 'recall_fake': 0.8818998716302953, 'precision': 0.800306473785771, 'precision_real': 0.9045643153526971, 'precision_fake': 0.6960486322188449, 'acc': 0.7990773962070733}
Max {'auc': 0.8743477460820952, 'spauc': 0.6401589875049951, 'metric': 0.7972544229113382, 'f1_real': 0.8164794007490638, 'f1_fake': 0.7780294450736126, 'recall': 0.8129635876922807, 'recall_real': 0.7440273037542662, 'recall_fake': 0.8818998716302953, 'precision': 0.800306473785771, 'precision_real': 0.9045643153526971, 'precision_fake': 0.6960486322188449, 'acc': 0.7990773962070733}

---------- epoch 13 ----------
----- in val progress... -----
current {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}
Max {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}

---------- epoch 14 ----------
----- in val progress... -----
current {'auc': 0.8637566977879227, 'spauc': 0.624496707514228, 'metric': 0.7835107015671363, 'f1_real': 0.8079226163058498, 'f1_fake': 0.7590987868284229, 'recall': 0.7958412377818767, 'recall_real': 0.7482935153583617, 'recall_fake': 0.8433889602053916, 'precision': 0.784001964149023, 'precision_real': 0.8778778778778779, 'precision_fake': 0.6901260504201681, 'acc': 0.7862634546386469}
Max {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}

---------- epoch 15 ----------
----- in val progress... -----
current {'auc': 0.8720936091164396, 'spauc': 0.641318857479651, 'metric': 0.785168026314757, 'f1_real': 0.8217257993867717, 'f1_fake': 0.7486102532427423, 'recall': 0.7891308538556914, 'recall_real': 0.8003412969283277, 'recall_fake': 0.7779204107830552, 'precision': 0.7828564999357078, 'precision_real': 0.8442844284428442, 'precision_fake': 0.7214285714285714, 'acc': 0.7913890312660175}
Max {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}

---------- epoch 16 ----------
----- in val progress... -----
current {'auc': 0.8566317410524564, 'spauc': 0.6167015972770035, 'metric': 0.7800783301715061, 'f1_real': 0.8062299587723316, 'f1_fake': 0.7539267015706805, 'recall': 0.7913444645493697, 'recall_real': 0.7508532423208191, 'recall_fake': 0.8318356867779204, 'precision': 0.7798935117957784, 'precision_real': 0.8704253214638972, 'precision_fake': 0.6893617021276596, 'acc': 0.7831881086622245}
Max {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}

---------- epoch 17 ----------
----- in val progress... -----
current {'auc': 0.859923679172125, 'spauc': 0.609469704219321, 'metric': 0.7869864923989177, 'f1_real': 0.8038004750593825, 'f1_fake': 0.770172509738453, 'recall': 0.8050806801403743, 'recall_real': 0.7218430034129693, 'recall_fake': 0.8883183568677792, 'precision': 0.793258327595247, 'precision_real': 0.9067524115755627, 'precision_fake': 0.6797642436149313, 'acc': 0.7883136852895951}
Max {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}

---------- epoch 18 ----------
----- in val progress... -----
current {'auc': 0.8654221085052595, 'spauc': 0.6238222304414908, 'metric': 0.7905954837304079, 'f1_real': 0.8171064604185623, 'f1_fake': 0.7640845070422535, 'recall': 0.8009491910079869, 'recall_real': 0.7662116040955631, 'recall_fake': 0.8356867779204108, 'precision': 0.7895137242505663, 'precision_real': 0.8752436647173489, 'precision_fake': 0.7037837837837838, 'acc': 0.7939518195797027}
Max {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}

test results: {'auc': 0.8553383078449042, 'spauc': 0.623940891820353, 'metric': 0.7811994522516408, 'f1_real': 0.8020589611605053, 'f1_fake': 0.7603399433427762, 'recall': 0.7890311155482659, 'recall_real': 0.7537379067722075, 'recall_fake': 0.8243243243243243, 'precision': 0.7812865404837014, 'precision_real': 0.857, 'precision_fake': 0.7055730809674028, 'acc': 0.7831881086622245}
best model path: ./param_model/ARG_zh-arg/1/parameter_bert.pkl
best macro f1: 0.7976543076568272
best_val_metric: {'auc': 0.8712135318317438, 'spauc': 0.6292653180660932, 'metric': 0.7976543076568272, 'f1_real': 0.8221307727480567, 'f1_fake': 0.7731778425655977, 'recall': 0.8090779944533772, 'recall_real': 0.7670648464163823, 'recall_fake': 0.8510911424903723, 'precision': 0.7970238095238096, 'precision_real': 0.8857142857142857, 'precision_fake': 0.7083333333333334, 'acc': 0.8006150691952845}
the_test_metric: {'auc': 0.8553383078449042, 'spauc': 0.623940891820353, 'metric': 0.7811994522516408, 'f1_real': 0.8020589611605053, 'f1_fake': 0.7603399433427762, 'recall': 0.7890311155482659, 'recall_real': 0.7537379067722075, 'recall_fake': 0.8243243243243243, 'precision': 0.7812865404837014, 'precision_real': 0.857, 'precision_fake': 0.7055730809674028, 'acc': 0.7831881086622245}
